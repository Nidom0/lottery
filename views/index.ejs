<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>سرای طلای ایرانیان</title>

  <!-- Vazir font + bootstrap icons -->
  <link href="https://fonts.googleapis.com/css2?family=Vazir:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="/public/css/public-chrome.css">

  <style>
#loanModal {
  position:fixed;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%) scale(.8);
  width:92%;
  max-width:520px;
  background: rgba(225,232,240,0.65);
  backdrop-filter: blur(10px);
  border-radius:16px;
  padding:20px;
  box-shadow:0 20px 60px rgba(0,0,0,.25);
  
  opacity:0;
  display:none;              /* modal hidden */
  pointer-events:none;       /* not clickable */
  transition: all .28s cubic-bezier(.2,.9,.2,1);
  z-index:3000;
}

#loanModal.open {
  display:block;
  opacity:1;
  pointer-events:auto;       /* clickable only when open */
  transform:translate(-50%,-50%) scale(1);
}


#loanModal h3{ margin:0 0 12px; text-align:center; color:#1e3b5a; }
.field{ margin-bottom:12px; }
.field label{ display:block; font-weight:600; margin-bottom:6px; color:#1e3b5a; }
.field input, .field select {
  width:100%;
  padding:10px 12px;
  border-radius:8px;
  border:1px solid #c8d2dc;
  font-size:15px;
  background:#fff;
}
.btn { width:100%; padding:12px; border-radius:10px; border:none; background:linear-gradient(90deg,#1e73be,#3a8dd5); color:#fff; font-weight:700; cursor:pointer; margin-top:8px; }
.close-btn { text-align:center; margin-top:10px; color:#666; cursor:pointer; }
.result { text-align:center; margin-top:10px; font-weight:700; color:#1e3b5a; }

/* ---------- page hero + retained content ---------- */
header {
  text-align:center;
  padding:80px 20px 50px;
  background: linear-gradient(to bottom,#e1e8f0,#d0d9e6); /* خاکستری/آبی gradient */
}
header h1 { margin:0 0 12px; font-size:40px; color:#1e73be; font-weight:700; }
header p { font-size:18px; color:#1e3b5a; margin-bottom:30px; }
.btn-login { background:#1e73be;color:white;padding:14px 38px;border-radius:50px;font-weight:600;font-size:1.1rem;text-decoration:none;display:inline-block;box-shadow:0 6px 20px rgba(30,115,190,0.4); transition:all .3s; }
.btn-login:hover { background:#3a8dd5; transform:translateY(-4px); box-shadow:0 10px 25px rgba(58,141,213,0.5); }

.section { padding:80px 20px; text-align:center; }
.section h2 { margin-bottom:55px; font-size:30px; color:#1e3b5a; position:relative; }
.section h2::after { content:''; width:90px; height:4px; background:#1e73be; display:block; margin:18px auto 0; border-radius:2px; }

.section-icon { font-size:3.8rem; color:#1e73be; background:white; width:100px; height:100px; border-radius:50%; display:flex; align-items:center; justify-content:center; margin:0 auto 30px; box-shadow:0 8px 30px rgba(0,0,0,0.12); transition:transform .3s; }
.section-icon:hover { transform:scale(1.1) rotate(8deg); }

.cards { display:flex; flex-wrap:wrap; justify-content:center; gap:30px; max-width:1250px; margin:0 auto; }
.card { background:#fff; border-radius:16px; padding:30px 24px; width:260px; box-shadow:0 6px 25px rgba(0,0,0,0.09); transition:all .4s; }
.card:hover { transform:translateY(-12px); box-shadow:0 18px 45px rgba(0,0,0,0.15); }
.card h3 { margin:0 0 14px 0; font-size:19px; color:#1e73be; }
.card p { font-size:15px; color:#555; margin:0; }

footer { background:linear-gradient(90deg,#1e73be,#3a8dd5); color:#fff; text-align:center; padding:50px 20px; margin-top:80px; }
footer p { margin:10px 0; font-size:15px; }

  </style>
</head>
<body class="public-body">

  <%- include('partials/public-chrome') %>

  <!-- ---------- LOAN POPUP (center modal) ---------- -->
  <div id="loanModal" aria-hidden="true">
    <h3>محاسبه وام</h3>

    <div class="field">
      <label>مبلغ وام (تومان)</label>
      <input id="loanAmount" inputmode="numeric" placeholder="مثال: 111,222,333">
    </div>

    <div class="field">
      <label>درصد سود سالانه (%)</label>
      <input id="loanInterest" type="number" placeholder="مثال: 18">
    </div>

   <div class="field">
  <label>تعداد اقساط (ماه)</label>
  <select id="loanMonths">
    <option value="12">۱۲ ماه</option>
    <option value="24">۲۴ ماه</option>
    <option value="36">۳۶ ماه</option>
    <option value="48">۴۸ ماه</option>
    <option value="60">۶۰ ماه</option>
    <option value="72">۷۲ ماه</option>
    <option value="84">۸۴ ماه</option>
    <option value="96">۹۶ ماه</option>
    <option value="108">۱۰۸ ماه</option>
    <option value="120">۱۲۰ ماه</option>
  </select>
</div>

    <button class="btn" id="calcLoanBtn">محاسبه وام</button>

    <div class="result" id="loanResult"></div>

    <div id="closeLoanBtn" 
     style="
       position:absolute;
       top:12px;
       left:12px;
       font-size:22px;
       font-weight:bold;
       cursor:pointer;
       color:#333;">
  ×
</div>

  </div>

  <!-- ---------- HERO + rest of original page (kept intact) ---------- -->
  <header>
    <h1>سرای طلای ایرانیان</h1>
    <p>سیستم جامع مدیریت قراردادها، وام‌ها و قرعه‌کشی‌ها</p>
    <div style="display:flex; gap:12px; justify-content:center; flex-wrap:wrap;">
      <a href="/customer/create-account" class="btn-login">ثبت‌نام برندگان</a>
      <a href="/customer/upload-info" class="btn-login" style="background:#4caf50;">بارگذاری اطلاعات</a>
    </div>
  </header>

  <!-- ویژگی‌های سیستم -->
  <section class="section">
    <div class="section-icon"><i class="bi bi-graph-up-arrow"></i></div>
    <h2>ویژگی‌های سیستم</h2>
    <div class="cards">
      <div class="card"><h3>گزارش گیری</h3><p>مشاهده و مدیریت گزارش‌ها و عملکرد سیستم</p></div>
      <div class="card"><h3>پشتیبانی مشتری</h3><p>مدیریت ارتباط با مشتریان و پاسخگویی سریع</p></div>
      <div class="card"><h3>امنیت بالا</h3><p>محافظت کامل از اطلاعات و دسترسی‌ها</p></div>
      <div class="card"><h3>مدیریت قراردادها</h3><p>کنترل و ثبت قراردادها و جزئیات آن‌ها</p></div>
    </div>
  </section>

  <!-- امکانات مدیران -->
  <section class="section bg-light">
    <div class="section-icon"><i class="bi bi-person-gear"></i></div>
    <h2>امکانات مدیران</h2>
    <div class="cards">
      <div class="card"><h3>ایجاد کاربر جدید</h3><p>مدیران می‌توانند کاربران جدید بسازند</p></div>
      <div class="card"><h3>مدیریت مشتریان</h3><p>ویرایش و مشاهده اطلاعات مشتریان</p></div>
      <div class="card"><h3>ایجاد قرعه‌کشی</h3><p>ساخت لینک اختصاصی برای هر مشتری</p></div>
    </div>
  </section>

  <!-- امکانات مشتریان -->
  <section class="section">
    <div class="section-icon"><i class="bi bi-people"></i></div>
    <h2>امکانات مشتریان</h2>
    <div class="cards">
      <div class="card"><h3>ثبت درخواست وام</h3><p>ثبت و مشاهده درخواست‌های وام</p></div>
      <div class="card"><h3>دریافت اطلاعیه‌ها</h3><p>دریافت پیام‌ها و اعلان‌ها</p></div>
      <div class="card"><h3>شرکت در قرعه‌کشی</h3><p>امکان مشاهده وضعیت قرعه‌کشی‌ها</p></div>
    </div>
  </section>

  <footer>
    <p>تماس با ما: 021-91004056</p>
    <p>ایمیل: support@SarayeTalaMehrGostaranIranian.ir</p>
    <p class="mt-3">© ۱۴۰۴ - سرای طلای ایرانیان - تمامی حقوق محفوظ است</p>
  </footer>

  <!-- ---------- SCRIPTS ---------- -->
  <script>

// ---------- overlay reference ----------
const overlay = document.getElementById('overlay');

// ---------- Loan Modal ----------
const loanModal = document.getElementById('loanModal');
const openLoanBtn = document.getElementById('openLoanBtn');
const closeLoanBtn = document.getElementById('closeLoanBtn');

function loanModalOpen() {
  loanModal.classList.add("open");
  overlay.style.display = "block";
}

function loanModalClose() {
  loanModal.classList.remove("open");
  overlay.style.display = "none";
}


closeLoanBtn.addEventListener('click', loanModalClose);
overlay.addEventListener('click', loanModalClose);
document.addEventListener('overlay:closed', loanModalClose);

// ---------- loan calculator ----------
const loanAmount = document.getElementById('loanAmount');
const loanInterest = document.getElementById('loanInterest');
const loanMonths = document.getElementById('loanMonths');
const calcLoanBtn = document.getElementById('calcLoanBtn');
const loanResult = document.getElementById('loanResult');

function formatThousandsEN(value) {
  const onlyNums = String(value).replace(/[^0-9]/g, '');
  if (onlyNums === '') return '';
  return onlyNums.replace(/\B(?=(\d{3})+(?!\d))/g, ',');
}

loanAmount.addEventListener('input', (e) => {
  e.target.value = formatThousandsEN(e.target.value);
});

calcLoanBtn.addEventListener('click', () => {
  const principal = Number(loanAmount.value.replace(/,/g, ''));
  const interest = Number(loanInterest.value);
  const months = Number(loanMonths.value);

  if (!principal || !interest || !months) {
    loanResult.innerText = 'لطفا تمام فیلدها را به درستی وارد کنید';
    return;
  }

  const totalInterest = principal * (interest / 100);
  const totalPay = principal + totalInterest;
  const monthly = Math.round(totalPay / months);

  loanResult.innerHTML = `
    مبلغ هر قسط: ${monthly.toLocaleString('en-US')} تومان<br>
    مجموع پرداخت: ${totalPay.toLocaleString('en-US')} تومان
  `;
});

// ---------- ESC close ----------
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') {
    loanModalClose();
  }
});

</script>

</body>
</html>
